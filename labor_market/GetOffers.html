{% block title %}Employer offers (Period {{ subsession.round_number }}/{{ C.NUM_ROUNDS }} | Step {{ player.offer_step }}/{{ C.HIRING_STEPS }}){% endblock %}

{{ block content }}
<div class="row gx-5 px-3">
  <div class="col-7">
    <h3>Offer choice</h3>

    <p>Below is the list of offers you got from the Managers. Choose one offer to accept, or reject them all.</p>

    <p>The offers are binding: the same Managers cannot make you another offer this Period, but you may be given different offers by other Managers.</p>

    <table class="table table-bordered table-striped text-center employee-choice-table">
      <thead>
        <tr>
          <th style="width: 10%;">Choice</th>
          <th style="width: 50%;">Company</th>
          <th style="width: 20%;">Wage</th>
          <th style="width: 20%;">Training</th>
        </tr>
      </thead>
      <tbody>
        {% for offer in open_offers %}
        <tr>
          <td>
            <input class="form-check-input" type="radio" id="id_player_matched-{{ forloop.counter0 }}" name="player_matched" required value="{{ offer.manager.id_in_group }}" />
          </td>
          <td>{{ offer.manager.label }}</td>
          <td>{{ offer.wage }}</td>
          <td>{{ if offer.training }}Included{{ else }}Not included{{ endif }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <input class="d-none" type="radio" id="id_player_matched-{{ num_offers }}" name="player_matched" required value="0" />

    {{ formfield_errors 'player_matched' }}

    <button class="btn btn-primary btn-lg" onclick="document.getElementById('id_player_matched-{{ num_offers }}').checked = false;">Accept offer</button>
    <button class="btn btn-warning btn-lg" name="player_matched" value="0" onclick="document.getElementById('id_player_matched-{{ num_offers }}').checked = true;">Reject all</button>
  </div>
  <div class="col-5">
    {{ include 'labor_market/components/EmployeeSidebar.html' }}
  </div>
</div>
{{ endblock }}

{{ block scripts }}
<script type="module">
  function selectChoice() {
    for (const el of document.querySelectorAll(".row-selected")) {
      el.classList.remove("row-selected");
    }

    this.closest("tr")?.classList.add("row-selected");

    for (const row of document.querySelectorAll(`.offer-history-table tr[data-id-in-group='${this.value}']`)) {
      row.classList.add("row-selected");
    }
  }

  for (const el of document.querySelectorAll("input[name='player_matched']")) {
    el.addEventListener("change", selectChoice);
  }
</script>
{{ endblock }}

{{ block styles }}
<style>
  .otree-body {
    max-width: 1870px;
  }

  .otree-title {
    text-align: center;
    padding-top: 0;
  }

  .employee-choice-table tr.row-selected {
    background-color: hsl(from var(--bs-primary) h s 90%);
  }

  .offer-history-table tr.row-selected {
    background-color: hsl(from var(--bs-info) h s 90%);
  }
</style>
{{ endblock }}